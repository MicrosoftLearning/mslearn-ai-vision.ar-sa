---
lab:
  title: تصنيف الصور باستخدام نموذج الذكاء الاصطناعي في Azure Vision المخصص
  module: Module 2 - Develop computer vision solutions with Azure AI Vision
---

# تصنيف الصور باستخدام نموذج الذكاء الاصطناعي في Azure Vision المخصص

يمكنك الذكاء الاصطناعي في Azure Vision من تدريب نماذج مخصصة لتصنيف العناصر واكتشافها باستخدام التسميات التي تحددها. في هذا التمرين المعملي، سنبني نموذج تصنيف صور مخصص لتصنيف صور الفاكهة.

## توفير مورد لرؤية الكمبيوتر

إذا لم يكن لديك مورد **Computer Vision** في اشتراكك بالفعل، فستحتاج إلى إنشائه.

1. افتح مدخل Azure على `https://portal.azure.com`، وسجل الدخول باستخدام حساب Microsoft المقترن باشتراك Azure.
1. حدد **Create a resource.**
1. في شريط البحث، ابحث عن *Computer Vision*، ثم حدد **Computer Vision**، وأنشئ المورد باستخدام الإعدادات التالية:
    - **Subscription**: *اشتراكك في Azure*
    - **مجموعة الموارد**: *اختر أو أنشئ مجموعة موارد (إذا كنت تستخدم اشتراكاً مقيداً، فقد لا يكون لديك إذن لإنشاء مجموعة موارد جديدة - استخدم المجموعة المتوفرة)*
    - **المنطقة**: *اختر من بين شرق الولايات المتحدة أو غرب الولايات المتحدة أو وسط فرنسا أو وسط كوريا أو شمال أوروبا أو جنوب شرق آسيا أو غرب أوروبا أو شرق آسيا\**
    - **الاسم**: *أدخل اسماً فريداً*
    - **مستوى التسعير**: مجاني (F0)

    \*تتوفر ميزات الذكاء الاصطناعي في Azure اصدار 4.0 حالياً في هذه المناطق فقط.

1. حدد مربعات الاختيار المطلوبة ثم أنشئ المورد.
<!--4. When the resource has been deployed, go to it and view its **Keys and Endpoint** page. You will need the endpoint and one of the keys from this page in a future step. Save them off or leave this browser tab open.-->

نحتاج أيضاً إلى حساب تخزين لتخزين صور التدريب.

1. في مدخل Microsoft Azure، ابحث عن **حسابات التخزين** وحددها، وأنشئ حساب تخزين جديداً بالإعدادات التالية:
    - **Subscription**: *اشتراكك في Azure*
    - **مجموعة الموارد**: *اختَر مجموعة الموارد نفسها التي أنشأت فيها مورد Custom Vision الخاص بك*
    - **اسم حساب التخزين**: customclassifySUFFIX 
        - *ملاحظة: استبدل الرمز المميز `SUFFIX` بالأحرف الأولى من اسمك أو قيمة أخرى لضمان أن يكون اسم المورد فريدًا على مستوى عالمي.*
    - **المنطقة**: *اختر المنطقة نفسها التي استخدمتها لمورد خدمة الذكاء الاصطناعي في Azure*
    - **الخدمة الأساسية**: تخزين Azure الكائن الثنائي كبير الحجم BLOB أوAzure Data Lake Storage Gen 2
    - **حمل العمل الأساسي**: غير ذلك
    - **الأداء:** قياسي
    - **التكرار**: التخزين المتكرر محلياً (LRS)

1. بعد توزيع المورد، حدد **انتقل إلى المورد**.
1. تمكين الوصول العام إلى حساب التخزين. في الجزء الأيمن، انتقل إلى **التكوين** في مجموعة **الإعدادات**، وبوسعك تمكين *السماح بالوصول المجهول لكائن ثنائي كبير الحجم*. حدد **حفظ**
1. في الجزء الأيسر، في **تخزين البيانات**، حدد **الحاويات** وقم بإنشاء حاوية جديدة باسم `fruit`، واضبط **مستوى الوصول المجهول** على *الحاوية (إمكانية وصول القراءة فقط بشكل مجهول للحاويات والكائنات)*.

    > **ملاحظة**: إذا تعطل **مستوى الوصول المجهول**، فعليك تحديث صفحة المستعرض.
   
## استنساخ المستودع لهذه الدورة التدريبية

تم توفير ملفات الصور لتدريب النموذج الخاص بك في مستودع GitHub. ستنسخ المستودع وتحمِّل الصور إلى حساب التخزين الخاص بك باستخدام Cloud Shell من مدخل Microsoft Azure. 

> **تلميح**: إذا كنت قد نسخت المستودع **mslearn-ai-vision** مؤخرًا بالفعل، فيمكنك تخطي مهمة النسخ. أما إذا لم تفعل، فاتبع هذه الخطوات لنسخ المستودع إلى بيئة التطوير الخاصة بك.

1. في بوابة Azure، استخدم الزر **[\>_]** على يمين شريط البحث أعلى الصفحة لإنشاء Cloud Shell جديد في بوابة Azure، وتحديد بيئة ***PowerShell***. يوفّر Cloud Shell واجهة سطر أوامر في جزء أسفل بوابة Azure.

    > **ملاحظة**: إذا كنت قد أنشأت مسبقًا Cloud Shell يستخدم بيئة *معالج Bash*، فبدّل إلى ***PowerShell***.

1. في شريط أدوات Cloud Shell، في قائمة **الإعدادات**، حدد **الانتقال إلى الإصدار الكلاسيكي** (هذا مطلوب لاستخدام محرر التعليمات البرمجية).

    > **تلميح**: عند لصق الأوامر في CloudShell، قد يشغل الإخراج مساحة كبيرة من ذاكرة التخزين المؤقت للشاشة. يمكنك مسح الشاشة عن طريق إدخال الأمر `cls` لتسهيل التركيز على كل مهمة.

1. في جزء PowerShell، أدخل الأوامر التالية لاستنساخ مستودع GitHub لهذا التمرين:

    ```
    rm -r mslearn-ai-vision -f
    git clone https://github.com/microsoftlearning/mslearn-ai-vision mslearn-ai-vision
    ```

1. بعد نسخ المستودع، انتقل إلى المجلد الذي يحتوي على ملفات التمرين:  

    ```
   cd mslearn-ai-vision/Labfiles/02-image-classification
    ```

1. شغِّل الأمر `code replace.ps1` وراجع التعليمات البرمجية. سترى أنه يستبدل اسم حساب التخزين الخاص بك للعنصر النائب في ملف JSON (ملف COCO) الذي نستخدمه في خطوة لاحقة.
1. استبدل العنصر النائب *في السطر الأول فقط* من الملف باسم حساب التخزين الخاص بك.
1. بعد استبدال العناصر النائبة، وفي محرر التعليمات البرمجية، استخدم الأمر **CTRL+S** أو **Right-click > Save** لحفظ التغييرات، ثم استخدم الأمر **CTRL+Q** أو **Right-click > Quit** لإغلاق المحرر مع ترك سطر أوامر Cloud Shell مفتوحًا.
1. قم بتشغيل البرنامج النصي مع الأمر التالي:

    ```powershell
    ./replace.ps1
    ```

1. يمكنك مراجعة ملف COCO للتأكد من وجود اسم حساب التخزين الخاص بك. شغِّل `code training-images/training_labels.json` واعرض الإدخالات الأولى. في الحقل *absolute_url*، يجب أن ترى شيئاً مشابهاً لـ *"https://myStorage.blob.core.windows.net/fruit/...*. إذا لم يكن التغيير متوقعاً، فتأكد من تحديث العنصر النائب الأول فقط في البرنامج النصي PowerShell.
1. أغلِق محرر التعليمات البرمجية.
1. شغِّل الأمر التالي، مع استبدال `<your-storage-account>` باسم حساب التخزين الخاص بك، لتحميل محتوى المجلد **training-images** إلى الحاوية `fruit` التي أنشأتها سابقًا.

    ```powershell
    az storage blob upload-batch --account-name <your-storage-account> -d fruit -s ./training-images/
    ```

1. افتح الحاوية `fruit` وتحقق من أن الملفات تم تحميلها بشكل صحيح.

## إنشاء مشروع تدريب نموذج مخصص

بعد ذلك، ستنشئ مشروع تدريب جديد لتصنيف الصور المخصصة في Vision Studio.

1. في مستعرض الويب، انتقل إلى `https://portal.vision.cognitive.azure.com/` وسجل الدخول باستخدام حساب Microsoft حيث أنشأت مورد الذكاء الاصطناعي في Azure.
1. حدد مربع **تخصيص النماذج باستخدام الصور** (يمكن العثور عليه في علامة التبويب **تحليل الصورة** إذا لم يظهر في العرض الافتراضي لديك).
1. حدد مورد خدمة الذكاء الاصطناعي في Azure الذي قمت بإنشائه للتو.
1. في مشروعك، حدد **إضافة مجموعة بيانات جديدة** في الأعلى. تكوين بالإعدادات التالية:
    - **اسم مجموعة البيانات**: training_images
    - **نوع النموذج**: تصنيف الصور
    - **حدد حاوية تخزين كائن ثنائي كبير الحجم من Azure**: حدد **تحديد حاوية**
        - **Subscription**: *اشتراكك في Azure*
        - **حساب التخزين**: *حساب التخزين الذي أنشأته*
        - **حاوية كائن ثنائي كبير الحجم**: فاكهة
    - حدد المربع "السماح لـ Vision Studio بالقراءة والكتابة في وحدة تخزين الكائن الثنائي الكبير الخاص بك"
1. حدد مجموعة بيانات **training_images**.

في هذه المرحلة من إنشاء المشروع، عادةً ما تحدد إنشاء **مشروع تسمية بيانات Azure ML** وتسمية صورك، ما يؤدي إلى إنشاء ملف COCO. نشجعك على تجربة ذلك إذا كان لديك الوقت، ولكن لأغراض هذا الدرس التطبيقي، سمينا بالفعل الصور لك ووفرنا ملف COCO الناتج.

1. تحديد **إضافة ملف COCO**
1. في القائمة المنسدلة، حدد **استيراد ملف COCO من حاوية كائن ثنائي كبير الحجم**
1. نظرا لأنك قمت بالفعل بتوصيل الحاوية الخاصة بك باسم `fruit`، يبحث Vision Studio عن ملف COCO. حدد **training_labels.json** من القائمة المنسدلة، وأضف ملف COCO.
1. انتقل إلى **النماذج المخصصة** على اليسار، وحدد **تدريب نموذج جديد**. استخدم الإعدادات التالية:
    - **اسم النموذج**: classifyfruit
    - **نوع النموذج**: تصنيف الصور
    - **اختيار مجموعة بيانات التدريب**: training_images
    - اترك الباقي كإعداد افتراضي، ثم حدد **نموذج القطار**

يمكن أن يستغرق التدريب بعض الوقت - الميزانية الافتراضية تصل إلى ساعة، ولكن بالنسبة لمجموعة البيانات الصغيرة هذه عادة ما تكون أسرع بكثير من ذلك. حدد زر **التحديث** كل دقيقتين حتى *نجاح* حالة المهمة. حدد النموذج.

هنا يمكنك عرض أداء وظيفة التدريب. راجع دقة النموذج المدرب وضبطه المحكم.

## تجربة نموذجك المخصص

النموذج الخاص بك مدرب وأصبح جاهزاً للاختبار.

1. في أعلى الصفحة الخاصة بالنموذج المخصص، حدد **تجربته**.
1. حدد نموذج **classifyfruit** من القائمة المنسدلة التي تحدد النموذج الذي تريد استخدامه، ثم انتقل إلى المجلد **02-image-classification\test-images**.
1. حدد كل صورة واعرض النتائج. حدد علامة التبويب **JSON** في مربع النتائج لفحص استجابة JSON الكاملة.

<!-- Option coding example to run-->
## تنظيف الموارد

إذا كنت لا تستخدم موارد Azure التي أنشأتها في هذا المختبر لوحدات التدريب الأخرى، فيمكنك حذفها لتجنب تكبد المزيد من الرسوم.

1. افتح مدخل Azure في `https://portal.azure.com`، وفي شريط البحث العلوي، ابحث عن الموارد التي أنشأتها في هذا المختبر.

2. في صفحة المورد، حدد **حذف** واتبع الإرشادات لحذف المورد. بدلاً من ذلك، يمكنك حذف مجموعة الموارد بأكملها لتنظيف جميع الموارد في الوقت نفسه.
